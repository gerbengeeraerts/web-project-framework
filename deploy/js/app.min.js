/*! IAMDEVLOPR-GRUNT Gerben Geeraerts 2017-02-25 */
!function(){function a(){setInterval(function(){var a=$.ajax({url:"api/profile/getCruiseFind/",method:"GET"});a.done(function(a){if(1===a.value){console.log("Part found");var b=$("#notification").html(),c=Handlebars.compile(b);if($(".notifications ul").append(c(a.data)),$(".inventoryList").length){$(".loaderNotification").hide();var b=$("#garage-inventory").html(),c=Handlebars.compile(b);$(".inventoryList").append(c(a.data))}}})},3e3)}function b(){console.log("close Modals"),$("body").removeClass("modal-open"),$(".modalContainer").fadeTo("250","0"),$(".modalContainer").css("display","none")}function c(){console.log("enable Modals"),$("body").addClass("modal-open"),$(".modalContainer").show("250"),$(".modalContainer").fadeTo("250","1")}if(a(),$("button.logIn").click(function(a){c(),console.log("enable Loin Modals"),$(".loginModal").show("250").fadeTo("250","1"),$(".logInComplete").click(function(){var a=0;if($.ajax({url:"api/players/checkEmail/",method:"GET",data:{email:$(".loginEmail").val()}}).done(function(b){1==b.value?(a++,$(".loginEmail").addClass("error"),console.log(b.response)):$(".loginEmail").addClass("success")}).fail(function(a){console.log(a)}),""===$(".loginPassword").val()&&(a++,$(".loginPassword").addClass("error"),console.log("Password cannot be empty")),0===a){var b=$.ajax({url:"api/players/loginPlayer/",method:"POST",data:{email:$(".loginEmail").val(),password:$(".loginPassword").val()}});b.done(function(a){1===a.value?(console.log("Player logged in"),window.location.href=""+a.redirect):(console.log("Failed"),console.log(a.response))})}})}),$("button.signUp").click(function(a){c(),console.log("enable Signup Modals"),$(".signUpModal").show("250").fadeTo("250","1"),$(".signUpComplete").click(function(){var a=0;if($.ajax({url:"api/players/checkUsername/",method:"GET",data:{username:$(".signUpUsername").val()}}).done(function(b){0==b.value?(a++,$(".signUpUsername").addClass("error"),console.log(b.response)):$(".signUpUsername").addClass("success")}).fail(function(a){console.log(a)}),$.ajax({url:"api/players/checkEmail/",method:"GET",data:{email:$(".signUpEmail").val()}}).done(function(b){0==b.value?(a++,$(".signUpEmail").addClass("error"),console.log(b.response)):$(".signUpEmail").addClass("success")}).fail(function(a){console.log(a)}),""===$(".signUpPassword").val()&&(a++,$(".signUpPassword").addClass("error"),console.log("Password cannot be empty")),$(".signUpTerms").is(":checked")||(a++,$(".signUpTerms").addClass("error")),0===a){console.log("No signup errors");var b=$.ajax({url:"api/players/createPlayer/",method:"POST",data:{username:$(".signUpUsername").val(),email:$(".signUpEmail").val(),password:$(".signUpPassword").val(),referral:$(".signUpReferral").val()}});b.done(function(a){console.log(a),1===a.value?(console.log("Player created"),console.log(a.redirect),window.location.href=""+a.redirect):(console.log("Failed"),console.log(a.response))}),b.fail(function(a){})}})}),$(".closeModal").click(function(a){b()}),$(".garageLoader").length){var d=$.ajax({url:"api/profile/getGarage/",method:"GET"});d.done(function(a){if(1===a.value){console.log("Garage loaded"),$(".loaderNotification").hide();var b=$("#garage-car").html(),c=Handlebars.compile(b);for(console.log(a.data),i=0;i<a.data.length;i++)$(".garageList").append(c(a.data[i]))}else console.log("Failed"),console.log(a.response)})}if($(".inventoryLoader").length){var d=$.ajax({url:"api/profile/getInventory/",method:"GET"});d.done(function(a){if(1===a.value){console.log("Inventory loaded"),$(".loaderNotification").hide();var b=$("#garage-inventory").html(),c=Handlebars.compile(b);for(console.log(a.data),i=0;i<a.data.length;i++)$(".inventoryList").append(c(a.data[i]));$(".salvage-part").off().on("click",function(a){a.stopImmediatePropagation();var b=$(this);$.ajax({url:"api/parts/salvage-part/",method:"POST",data:{id:$(this).attr("data-id"),inventoryId:$(this).attr("data-inventory-id")}}).done(function(a){console.log(a),1===a.value&&(b.closest(".inventoryListChild").hide(),$(".playerCredits").prop("Counter",$(".playerCredits").text()).animate({Counter:a.data.credits},{duration:1500,easing:"swing",step:function(a){$(".playerCredits").text(Math.ceil(a))}}))}).fail(function(a){console.log(a)})})}else console.log("Failed"),console.log(a.response)})}}();